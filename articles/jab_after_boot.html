<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>jab_after_boot • semboottools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Cabin-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Cousine-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="jab_after_boot">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">semboottools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/semboottools.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gg_hist_qq_boot_and_gg_scatter_boot.html">gg_hist_qq_boot_and_gg_scatter_boot</a></li>
    <li><a class="dropdown-item" href="../articles/jab_after_boot.html">jab_after_boot</a></li>
    <li><a class="dropdown-item" href="../articles/parameterEstimates_boot.html">parameterEstimates_boot</a></li>
    <li><a class="dropdown-item" href="../articles/standardizedSolution_boot.html">semboottools::standardizedSolution_boot</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Yangzhen1999/semboottools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>jab_after_boot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Yangzhen1999/semboottools/blob/main/vignettes/jab_after_boot.Rmd" class="external-link"><code>vignettes/jab_after_boot.Rmd</code></a></small>
      <div class="d-none name"><code>jab_after_boot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates how to use <code><a href="../reference/jab_after_boot.html">jab_after_boot()</a></code>
to compute <strong>Jackknife-after-Bootstrap (JAB)</strong> influence
values for a single model parameter from a <code>lavaan</code> fit with
stored bootstrap replicates (including<code>boot.idx</code>). The
function summarizes the full bootstrap distribution and the
leave-one-out (LOO) subdistributions, ranks influential observations,
and (optionally) plots a diagnostic figure.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Yangzhen1999.github.io/semboottools/">semboottools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is lavaan 0.6-19</span></span>
<span><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h2>
<p>The function <code><a href="../reference/jab_after_boot.html">jab_after_boot()</a></code> accepts the following
arguments:</p>
<table class="table">
<colgroup>
<col width="35%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>fit</code></td>
<td>A fitted <code>lavaan</code> object for which
<code><a href="../reference/store_boot.html">store_boot()</a></code> has been called with
<code>keep.idx = TRUE</code>. Must contain
<code>fit@external$sbt_boot_ustd</code> (with <code>boot.idx</code>
attribute), and typically <code>fit@external$sbt_boot_std</code>.</td>
</tr>
<tr class="even">
<td><code>param</code></td>
<td>The target parameter to diagnose. Can be given as (i)
<code>"lhs op rhs"</code> (e.g., <code>"Y ~ X"</code>,
<code>"Y ~~ Y"</code>, <code>"X =~ x1"</code>), (ii) a user-defined
<code>":="</code> label (e.g., <code>"ab"</code>), or (iii) a parameter
label (e.g., <code>"b"</code>).</td>
</tr>
<tr class="odd">
<td><code>standardized</code></td>
<td>Logical. If <code>TRUE</code>, use standardized bootstrap estimates
(<code><a href="../reference/standardizedSolution_boot.html">standardizedSolution_boot()</a></code>); if <code>FALSE</code>, use
unstandardized (<code><a href="../reference/parameterEstimates_boot.html">parameterEstimates_boot()</a></code>).</td>
</tr>
<tr class="even">
<td><code>top_k</code></td>
<td>Integer. Number of most influential cases (by absolute JAB value) to
report in the summary table.</td>
</tr>
<tr class="odd">
<td><code>ci_level</code></td>
<td>Numeric between 0 and 1. Confidence level for percentile bootstrap
confidence intervals recomputed on each leave-one-out (LOO)
subdistribution.</td>
</tr>
<tr class="even">
<td><code>min_keep</code></td>
<td>Integer. Minimum number of bootstrap replicates to retain in each
LOO subset. Default is <code>max(30, floor(0.2 * B))</code>.</td>
</tr>
<tr class="odd">
<td><code>plot</code></td>
<td>Logical. If <code>TRUE</code>, produce a diagnostic plot showing
full-sample bootstrap mean and case-deleted bootstrap means.</td>
</tr>
<tr class="even">
<td><code>plot_engine</code></td>
<td>Character. Choose <code>"ggplot2"</code> (default, modern graphics)
or <code>"base"</code> (basic R graphics) for the plot.</td>
</tr>
<tr class="odd">
<td><code>ylab_override</code></td>
<td>Optional character. Override the default y-axis label in the
plot.</td>
</tr>
<tr class="even">
<td><code>verbose</code></td>
<td>Logical. If <code>TRUE</code> (default), print summaries to console
(ALL vs. LOO).</td>
</tr>
<tr class="odd">
<td><code>font_family</code></td>
<td>Character. Font family for plotting (default <code>"serif"</code>).
Use <code>"sans"</code> or <code>"Times New Roman"</code> for
cross-platform robustness.</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h2>
<p>The function returns a list with the following components:</p>
<table class="table">
<colgroup>
<col width="35%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>param</code></td>
<td>The target parameter string.</td>
</tr>
<tr class="even">
<td><code>standardized</code></td>
<td>Logical flag indicating whether standardized bootstrap was
used.</td>
</tr>
<tr class="odd">
<td><code>full_summary</code></td>
<td>Data frame with the summary statistics (mean, SE, CI) for the full
bootstrap distribution (<code>scope = "ALL"</code>).</td>
</tr>
<tr class="even">
<td><code>cases_summary</code></td>
<td>Data frame of the top <code>top_k</code> cases ranked by absolute
JAB influence, with case index, JAB value, and LOO summaries.</td>
</tr>
<tr class="odd">
<td><code>F</code></td>
<td>The B × n occurrence matrix (bootstrap replicate by
observation).</td>
</tr>
<tr class="even">
<td><code>tstar</code></td>
<td>Full bootstrap vector for the parameter.</td>
</tr>
<tr class="odd">
<td><code>plot_obj</code></td>
<td>A <code>ggplot</code> object if <code>plot = TRUE</code> and
<code>plot_engine = "ggplot2"</code>, otherwise <code>NULL</code>.</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">m</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  m ~ a * x</span></span>
<span><span class="st">  y ~ b * m + cp * x</span></span>
<span><span class="st">  ab := a * b</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="co"># Fit model</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="va">dat</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store bootstrap draws</span></span>
<span><span class="co"># Before calling `jab_after_boot()`, you **must** re-run the model with store_boot(keep.idx = TRUE).  This is crucial: without `keep.idx = TRUE`, the bootstrap index matrix (boot.idx) will not be saved, and JAB cannot compute leave-one-out subdistributions.</span></span>
<span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/store_boot.html">store_boot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit0</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  iseed <span class="op">=</span> <span class="fl">2345</span>,        </span>
<span>  keep.idx <span class="op">=</span> <span class="cn">TRUE</span>           </span>
<span><span class="op">)</span></span></code></pre></div>
<p>When you run <code><a href="../reference/jab_after_boot.html">jab_after_boot()</a></code> with
<code>verbose = TRUE</code>, two blocks of output are shown:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Full-sample bootstrap summary (ALL)</strong><br>
This block reports the overall bootstrap distribution of the chosen
parameter across all bootstrap replicates. It includes the bootstrap
mean, the standard error (SE), and the percentile confidence interval.
These values are consistent with what you would obtain from
<code><a href="../reference/standardizedSolution_boot.html">standardizedSolution_boot()</a></code> or
<code><a href="../reference/parameterEstimates_boot.html">parameterEstimates_boot()</a></code> without JAB. In other words, it
is the reference point against which the leave-one-out results are
compared.</p></li>
<li><p><strong>Leave-one-out (LOO) summaries</strong><br>
This block lists the top <code>top_k</code> most influential cases,
ranked by the absolute JAB influence statistic. For each case, it
shows:</p></li>
</ol>
<ul>
<li>
<strong>JAB_value</strong>: the influence index
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>j</mi></msub><mo>=</mo><mi>n</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mover><mi>θ</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mover><mi>θ</mi><mo accent="true">‾</mo></mover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
I_j = n \big( \bar{\theta}_{(-j)} - \bar{\theta} \big)
</annotation></semantics></math> Large positive values mean that
excluding the case increases the bootstrap mean; large negative values
mean it decreases the bootstrap mean.</li>
<li>
<strong>mean, SE, CI.Lo, CI.Up</strong>: the bootstrap mean,
standard error, and confidence interval recomputed when this case is
excluded from the resampling. By comparing these numbers to the
full-sample summary, you can diagnose which individual observations
exert the strongest influence on the bootstrap results.</li>
</ul>
<p>The diagnostic plot visualizes the same information:</p>
<ul>
<li><p><strong>Black points</strong>: leave-one-out bootstrap means for
each observation.</p></li>
<li><p><strong>Blue points</strong>: the most influential cases (top
<code>top_k</code> by absolute JAB value).</p></li>
<li><p><strong>Horizontal line</strong>: the full-sample bootstrap mean,
serving as the reference. If a case is highly influential, its
corresponding point will be far away from the horizontal line. The plot
therefore provides an intuitive complement to the numeric summaries
shown above.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run JAB analysis for b</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">semboottools</span><span class="fu">::</span><span class="fu"><a href="../reference/jab_after_boot.html">jab_after_boot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit2</span>,</span>
<span>  param        <span class="op">=</span> <span class="st">"b"</span>,       </span>
<span>  standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  top_k        <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  plot         <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_engine  <span class="op">=</span> <span class="st">"ggplot2"</span>,</span>
<span>  font_family  <span class="op">=</span> <span class="st">"sans"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Full-sample bootstrap summary (ALL) ===</span></span>
<span><span class="co">#&gt;  scope param      mean         SE     CI.Lo     CI.Up</span></span>
<span><span class="co">#&gt;    ALL     b 0.3377757 0.07087301 0.1941315 0.4714736</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Leave-one-out (LOO) summaries ===</span></span>
<span><span class="co">#&gt;  case JAB_value      mean         SE     CI.Lo     CI.Up</span></span>
<span><span class="co">#&gt;    92 -7.265716 0.3014471 0.06691697 0.1675634 0.4262696</span></span>
<span><span class="co">#&gt;   137  4.284467 0.3591980 0.07043389 0.2110645 0.4911241</span></span>
<span><span class="co">#&gt;    81 -4.052481 0.3175133 0.06999906 0.1731859 0.4480780</span></span>
<span><span class="co">#&gt;   193  3.876416 0.3571577 0.06899989 0.2152160 0.4887382</span></span>
<span><span class="co">#&gt;   127 -3.873037 0.3184105 0.07269465 0.1762345 0.4551080</span></span></code></pre></div>
<p><img src="jab_after_boot_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Run JAB analysis for ab</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">semboottools</span><span class="fu">::</span><span class="fu"><a href="../reference/jab_after_boot.html">jab_after_boot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit2</span>,</span>
<span>  param        <span class="op">=</span> <span class="st">"ab"</span>,       </span>
<span>  standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  top_k        <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot         <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Full-sample bootstrap summary (ALL) ===</span></span>
<span><span class="co">#&gt;  scope param       mean         SE       CI.Lo     CI.Up</span></span>
<span><span class="co">#&gt;    ALL    ab 0.02248262 0.02801863 -0.03249827 0.0801279</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Leave-one-out (LOO) summaries ===</span></span>
<span><span class="co">#&gt;  case  JAB_value       mean         SE       CI.Lo      CI.Up</span></span>
<span><span class="co">#&gt;   137  2.0694700 0.03282997 0.02927190 -0.02581250 0.08970996</span></span>
<span><span class="co">#&gt;    78  1.7594344 0.03127979 0.02776399 -0.02456933 0.08757414</span></span>
<span><span class="co">#&gt;   123 -1.5161302 0.01490197 0.02800061 -0.04028824 0.06810769</span></span>
<span><span class="co">#&gt;    86 -1.2273696 0.01634577 0.02687397 -0.03770233 0.06672054</span></span>
<span><span class="co">#&gt;    81  1.1724804 0.02834502 0.02614015 -0.02180055 0.08551743</span></span>
<span><span class="co">#&gt;   114 -0.9656210 0.01765451 0.02747352 -0.03468617 0.07179822</span></span>
<span><span class="co">#&gt;   113 -0.9207178 0.01787903 0.02811111 -0.03733626 0.07244217</span></span>
<span><span class="co">#&gt;    23  0.9070081 0.02701766 0.02802264 -0.02655530 0.08500396</span></span>
<span><span class="co">#&gt;    71  0.9052507 0.02700887 0.02817719 -0.02667212 0.08719627</span></span>
<span><span class="co">#&gt;    95  0.8340024 0.02665263 0.02756542 -0.02685990 0.08404846</span></span></code></pre></div>
<p><img src="jab_after_boot_files/figure-html/unnamed-chunk-3-2.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Efron, B., &amp; Tibshirani, R. J. (1993). <em>An Introduction to
the Bootstrap</em>. Chapman &amp; Hall.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wendie Yang, Shu Fai Cheung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
